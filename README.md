## –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –ø–∞–ø–æ–∫ –≤ –¥–æ–º–µ–Ω–µ Active Directory  

**PowerShell-—Å–∫—Ä–∏–ø—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–∞–ø–∫–∏ –Ω–∞ –≤—Å–µ—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö –¥–æ–º–µ–Ω–∞ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω—Å–∫—É—é —à–∞—Ä—É.**  

---

## ‚ö†Ô∏è –ö–ª—é—á–µ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è  
- **Active Directory**: –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Get-ADComputer` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –ü–ö.  
- **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–∞–≤–∞**:  
  - –ù–∞ –º–∞—à–∏–Ω–µ, –≥–¥–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç  
  - –î–æ—Å—Ç—É–ø –∫ `\\{PC_NAME}\c$\` (–∞–¥–º–∏–Ω—Å–∫–∞—è —à–∞—Ä–∞) –Ω–∞ —Ü–µ–ª–µ–≤—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö  
- **PowerShell 5.1+** –∏ –º–æ–¥—É–ª—å `ActiveDirectory`  

> **–í–∞–∂–Ω–æ!** –°–∫—Ä–∏–ø—Ç —É–¥–∞–ª—è–µ—Ç –ø–∞–ø–∫—É **—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ** –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è!  

---

## üõ† –ù–∞—Å—Ç—Ä–æ–π–∫–∞  

### 1. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã  
–ò–∑–º–µ–Ω–∏—Ç–µ –ø—É—Ç—å –∫ —É–¥–∞–ª—è–µ–º–æ–π –ø–∞–ø–∫–µ –≤ —Å–∫—Ä–∏–ø—Ç–µ (`delete_folder_all_pc.ps1`):  
```powershell
$folderPath = "\\$computer\c$\Users\Public\RAMCleaner"  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –ø—É—Ç—å  
```

### 2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏  
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |  
|----------|--------------|  
| **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–≤** | –î–æ–±–∞–≤—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä: `Get-ADComputer -Filter "OperatingSystem -notlike '*Server*'"` |  
| **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª** | –î–æ–±–∞–≤—å—Ç–µ `Start-Transcript -Path "C:\Logs\folder_cleanup.log"` –≤ –Ω–∞—á–∞–ª–æ —Å–∫—Ä–∏–ø—Ç–∞ |  
| **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** | –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ `$confirmation = Read-Host "–í—ã —É–≤–µ—Ä–µ–Ω—ã? (y/n)"` –ø–µ—Ä–µ–¥ —Ü–∏–∫–ª–æ–º |  

---

## üöÄ –ó–∞–ø—É—Å–∫  

### –í—Ä—É—á–Ω—É—é (—Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏):  
```powershell
powershell.exe -ExecutionPolicy Bypass -File "\\–ø—É—Ç—å\–∫\delete_folder_all_pc.ps1"
```

### –ß–µ—Ä–µ–∑ GPO (–¥–ª—è –¥–æ–º–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è):  
1. **–†–∞–∑–º–µ—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç** –≤ —Å–µ—Ç–µ–≤–æ–π –ø–∞–ø–∫–µ —Å –¥–æ—Å—Ç—É–ø–æ–º –¥–ª—è `Domain Computers`.  
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–ª–∏—Ç–∏–∫—É**:  
   - **Computer Configuration ‚Üí Policies ‚Üí Windows Settings ‚Üí Scripts ‚Üí Startup**  
   - –î–æ–±–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É:  
     ```powershell
     powershell.exe -ExecutionPolicy Bypass -File "\\—Å–µ—Ç–µ–≤–æ–π_–ø—É—Ç—å\delete_folder_all_pc.ps1"
     ```  

---

## üìä –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ  
–°–∫—Ä–∏–ø—Ç –≤—ã–≤–æ–¥–∏—Ç —Ü–≤–µ—Ç–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:  

| –¶–≤–µ—Ç | –°—Ç–∞—Ç—É—Å | –ó–Ω–∞—á–µ–Ω–∏–µ |  
|------|--------|----------|  
| üü¢ **–ó–µ–ª–µ–Ω—ã–π** | `[SUCCESS]` | –ü–∞–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∞ |  
| üî¥ **–ö—Ä–∞—Å–Ω—ã–π** | `[ERROR]` | –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è (–Ω–µ—Ç –ø—Ä–∞–≤/—Ñ–∞–π–ª –∑–∞–Ω—è—Ç) |  
| üü° **–ñ–µ–ª—Ç—ã–π** | `[SKIPPED]` | –ü–∞–ø–∫–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç |  
| ‚ö™ **–°–µ—Ä—ã–π** | `[OFFLINE]` | –ö–æ–º–ø—å—é—Ç–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω |  

---

## ‚ö†Ô∏è –¢–∏–ø–æ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã  

| –û—à–∏–±–∫–∞ | –†–µ—à–µ–Ω–∏–µ |  
|--------|---------|  
| **¬´Access Denied¬ª** | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ `c$` –∏ –∑–∞–ø—É—Å–∫ –æ—Ç **–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–æ–º–µ–Ω–∞** |  
| **¬´Cannot bind parameter Filter¬ª** | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –º–æ–¥—É–ª—å `ActiveDirectory` (`Add-WindowsFeature RSAT-AD-PowerShell`) |  
| **–°–∫—Ä–∏–ø—Ç –∑–∞–≤–∏—Å–∞–µ—Ç** | –î–æ–±–∞–≤—å—Ç–µ —Ç–∞–π–º–∞—É—Ç: `Test-Connection -ComputerName $computer -Count 1 -Timeout 2 -Quiet` |  

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å  
1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–∞—á–∞–ª–∞ –Ω–∞ 2-3 —Ç–µ—Å—Ç–æ–≤—ã—Ö –ü–ö.  
2. **–ë—ç–∫–∞–ø**: –î–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø–∞–ø–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:  
   ```powershell
   Compress-Archive -Path $folderPath -DestinationPath "\\backup\–ø–∞–ø–∫–∞_$computer.zip"
   ```  
3. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞**: –î–ª—è —Ç–æ—á–µ—á–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `-WhatIf`:  
   ```powershell
   Remove-Item -Path $folderPath -Recurse -Force -WhatIf
   ```  

---

## üí° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è  
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**: –î–æ–±–∞–≤—å—Ç–µ `ForEach-Object -Parallel` (—Ç—Ä–µ–±—É–µ—Ç—Å—è PS 7+):  
  ```powershell
  $computers | ForEach-Object -Parallel { ... } -ThrottleLimit 10
  ```  
- **–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ `Send-MailMessage` –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤.  

---

**–î–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** | –ê–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ –ø–æ–¥ –≤–∞—à—É –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É.  
Copyright ¬© 2025 –ö–æ–¥–µ–ª—å–Ω–∏–∫ –ú–∞–∫—Å–∏–º –°–µ—Ä–≥–µ–µ–≤–∏—á | MIT License
